"/Users/myron/Desktop/Noesis AI/Agentic_AI_test/.venv/bin/python" "/Users/myron/Desktop/Noesis AI/Agentic_AI_test/mcp/mcp_demo.py"
(.venv) (base) myron@MyronMacBook-Air Agentic_AI_test % "/Users/myron/Desktop/Noesis AI/Agentic_AI_test/.venv/bin/python" "/Users/myron/Desktop/Noesis AI/Agentic_AI_test/mcp/mcp_d
emo.py"
/Users/myron/Desktop/Noesis AI/Agentic_AI_test/.venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
✅ 已加载 6469 条token价格数据
============================================================
🚀 欢迎使用 Model Context Protocol (MCP) Demo
============================================================
🔧 OpenAI 可用: ✅
🔧 Dashscope 可用: ✅

🤖 请选择AI模型:
1. OpenAI GPT
2. 阿里云通义千问 (Qwen)
3. 离线模式 (仅使用本地功能)

请输入选择: 2
✅ 已选择 通义千问 模型

🔧 请选择需要的功能:
1. 📊 调用本地函数 (税务计算)
2. 🌤️  查询香港天气
3. 💰 查询本地数据库 (token价格)
4. 🤖 智能综合处理 (结合多功能)
5. ❌ 退出程序

请输入选择 (1-5): 1

📊 税务计算功能
请输入月工资总额（元）: 20000
请输入月五险一金（元，默认0）: 100
请输入月专项附加扣除（元，默认0）: 100 

💰 计算结果:
  计算结果: 月工资 ¥20,000.00 的个人所得税
  应缴税额: ¥1,550.00 (monthly)
  实际税率: 7.75%
  边际税率: 20.0%
扣除项目:
  - 年度起征点: ¥60,000.00
  - 年度五险一金: ¥1,200.00
  - 年度专项附加扣除: ¥1,200.00

是否继续使用？(y/n): y

🔧 请选择需要的功能:
1. 📊 调用本地函数 (税务计算)
2. 🌤️  查询香港天气
3. 💰 查询本地数据库 (token价格)
4. 🤖 智能综合处理 (结合多功能)
5. ❌ 退出程序

请输入选择 (1-5): 2

🌤️ 正在查询香港天气...

🌈 香港天气信息:
  查询时间: 2025-06-02 01:46:52
  数据源: 香港天文台官方API
  数据更新时间: 2025-06-02T01:02:00+08:00
  温度分布:
    - 京士柏: 28°C
    - 香港天文台: 29°C
    - 黄竹坑: 28°C
    - 打鼓岭: 27°C
    - 流浮山: 27°C
  相对湿度: 87%
  紫外线指数: N/A
  天气概况: 一股偏南气流正影响广东沿岸。此外，一道低压槽正为华南北部带来不稳定天气，预料该低压槽会在今日稍后靠近沿岸地区。
  今日预报: 大致多云，有几阵骤雨。早上最低气温约27度。日间部分时间有阳光及炎热，市区最高气温约32度，新界再高一两度。稍后局部地区有雷暴。吹和缓南至西南风。
  明日展望: 星期二及星期三间中有骤雨及几阵雷暴。本周后期骤雨逐渐减少，接近周末部分时间有阳光及炎热。
  天气警告:
    - 当前无天气警告
  火灾危险: 

是否继续使用？(y/n): y

🔧 请选择需要的功能:
1. 📊 调用本地函数 (税务计算)
2. 🌤️  查询香港天气
3. 💰 查询本地数据库 (token价格)
4. 🤖 智能综合处理 (结合多功能)
5. ❌ 退出程序

请输入选择 (1-5): 3

💰 本地数据库查询功能
例如: '查询最接近2025-01-10 0点时的aixbt的价格'
请输入查询内容: 查询最接近2025-01-10 0点时的aixbt的价格
🤖 正在使用AI解析自然语言查询: '查询最接近2025-01-10 0点时的aixbt的价格'
📋 AI生成的结构化查询: {'coins': ['aixbt'], 'time_filter': {'type': 'exact_date', 'value': '2025-01-10 00:00:00'}, 'conditions': {'price_range': {'min': None, 'max': None}, 'order_by': 'datetime', 'order_direction': 'asc', 'limit': 1}, 'query_type': 'price', 'confidence': 1.0}

📈 查询结果:
  原始查询: 查询最接近2025-01-10 0点时的aixbt的价格
  AI解析过程: {'coins': ['aixbt'], 'time_filter': {'type': 'exact_date', 'value': '2025-01-10 00:00:00'}, 'conditions': {'price_range': {'min': None, 'max': None}, 'order_by': 'datetime', 'order_direction': 'asc', 'limit': 1}, 'query_type': 'price', 'confidence': 1.0}
查询结果:
  1. {'时间': '2025-01-10 00:03:48', '币种': 'aixbt', '价格': '$0.393890', '市值': '$337,638,889.57', '24h交易量': '$80,530,306.35'}
  AI智能总结: 1. 查询旨在获取最接近2025年1月10日0点时aixbt的价格数据。  
2. 成功找到一条匹配记录，时间为2025-01-10 00:03:48，价格为$0.393890。  
3. aixbt在目标时间附近的市场价格为$0.393890，与查询时间点高度接近。
  技术说明: AI解析→本地查询→AI总结

是否继续使用？(y/n): 4

🔧 请选择需要的功能:
1. 📊 调用本地函数 (税务计算)
2. 🌤️  查询香港天气
3. 💰 查询本地数据库 (token价格)
4. 🤖 智能综合处理 (结合多功能)
5. ❌ 退出程序

请输入选择 (1-5): 4

🤖 智能综合处理功能
示例: '帮我查一查香港的天气，然后决定我出门穿什么，要不要带伞'
请描述您的需求: 帮我查一查香港的天气，然后决定我出门穿什么，要不要带伞
🔍 检测到天气相关查询，获取天气信息...
🤖 AI正在分析和处理...

💡 智能建议:
根据目前的香港天气信息：

### 天气情况总结：
- **当前温度**：不同地区的温度在27°C到29°C之间（例如京士柏28°C，香港天文台29°C）。
- **相对湿度**：87%，空气较潮湿。
- **天气概况**：大致多云，有几阵骤雨。
- **今日预报**：大致多云，有几阵骤雨，日间部分时间有阳光且炎热，市区最高气温约32°C。
- **风向风速**：吹和缓的南至西南风。
- **明日展望**：间中有骤雨及几阵雷暴。

### 穿衣建议：
- 鉴于今天是多云且有骤雨的情况，建议穿轻便透气的夏季服装，比如短袖T恤、薄外套或防晒衣。
- 因为气温较高（最高可达32°C），可以选择吸汗快干的材质，避免厚重衣物。

### 是否需要带伞：
- 根据预报，今天有几阵骤雨，而且相对湿度较高，外出时建议携带一把折叠伞，既可以遮阳也可以防雨。
- 如果不想带伞，也可以准备一件轻便的防雨外套，方便应对突如其来的降雨。

总之，今天的天气比较闷热且多雨，请注意补水并做好防晒或防雨措施！

是否继续使用？(y/n): 
